# SKN04-2nd-5Team
# ğŸ‘‘Class DomğŸ‘‘
<p align="center"><img src="./classdom/image/classdom.jpg" width="1000" height="300"/></p>

<hr>

### ğŸ¤— íŒ€ëª… : ê³¨ê³¨ëŒ€ì¡°
 
### ğŸ¤­ íŒ€ì›


<div align="center">
	
|&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;  &nbsp;  &nbsp; ğŸ¶ ë°•ì§„íš¨  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp;|&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; ğŸ± ê³ ìœ ë¦¼  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; |&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; ğŸ¹ ì´ì§„ì„­  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; |  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; ğŸ° ì´í˜¸ì¬  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp;|&nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; ğŸ± ì „ìš±ì§„  &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;  &nbsp;  &nbsp; |
| DL | ML | DL | ML | EDA |
|------------------------------------------|--------------------------------------|------------------------------------------|-----------------------------------|--------------------------------------|
 
</div>

<hr>

### ğŸ‘¨â€ğŸ« í”„ë¡œì íŠ¸ ê°œìš”
ì´ í”„ë¡œì íŠ¸ëŠ” ë¨¸ì‹ ëŸ¬ë‹, ë”¥ëŸ¬ë‹ì„ í™œìš©í•˜ì—¬ ê¸°ì—…ì˜ ê³ ê° ì´íƒˆì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ êµ¬ì¶•í•©ë‹ˆë‹¤. ì´ë¥¼ í†µí•˜ì—¬ ê¸°ì—…ì€ ê³ ê° ì¶©ì„±ë„ë¥¼ ë†’ì´ê³ , ë§ì¶¤í˜• ë§ˆì¼€íŒ… ì „ëµì„ ìˆ˜ë¦½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<hr>

### ğŸ‘©â€ğŸ« í”„ë¡œì íŠ¸ ëª©í‘œ
ì´ í”„ë¡œì íŠ¸ì˜ ì£¼ìš” ëª©í‘œëŠ” ê³ ê° ì´íƒˆ ì˜ˆì¸¡ ëª¨ë¸ì˜ ì •í™•ì„±ì„ ê·¹ëŒ€í™”í•˜ì—¬ ê¸°ì—…ì˜ ì˜ì‚¬ê²°ì •ì„ ì§€ì›í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ ë‹¤ì–‘í•œ ë°ì´í„° ë¶„ì„ ê¸°ë²•ê³¼ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ì„ ë¹„êµì ìš©í•˜ì—¬ ìµœì ì˜ ëª¨ë¸ì„ ê°œë°œí•©ë‹ˆë‹¤. ë˜í•œ, ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê³ ê° ìœ ì§€ ì „ëµì„ ì œì•ˆí•˜ì—¬ ì‹¤ì§ˆì ì¸ ë¹„ì¦ˆë‹ˆìŠ¤ ì„±ê³¼ë¥¼ í–¥ìƒì‹œí‚¤ê³ ì í•©ë‹ˆë‹¤. ê¶ê·¹ì ìœ¼ë¡œëŠ” ê³ ê° ê²½í—˜ì„ ê°œì„ í•˜ê³ , ì¥ê¸°ì ì¸ ê³ ê° ê´€ê³„ë¥¼ êµ¬ì¶•í•˜ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.

<hr>

### ğŸ”¨ ê¸°ìˆ  ìŠ¤íƒ
<div>
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://camo.githubusercontent.com/0d0779a129f1dcf6c31613b701fe0646fd4e4d2ed2a7cbd61b27fd5514baa938/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f707974686f6e2d3336373041303f7374796c653d666f722d7468652d6261646765266c6f676f3d707974686f6e266c6f676f436f6c6f723d666664643534">
</div>

<hr>

### Prerequisites
**ì´ í”„ë¡œì íŠ¸ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ íŒ¨í‚¤ì§€ ë“±ì„ ì •ì˜**

```cmd
pip install numpy
pip install pandas
pip install 
```

<hr>

### Usage

- Machine Learning
```cmd
python ./ML/ml.py
```
- Deep Learning
```cmd
python train.py
```

<hr> 

### Data

**1. NaNê°’ ì œê±°í•©ë‹ˆë‹¤.** <br>
<br>

**2. NaNì„ í•´ë‹¹ ì»¬ëŸ¼ì˜ medianê°’ìœ¼ë¡œ ì±„ì›ë‹ˆë‹¤.** <br>
<br>

**3. 2ë²ˆ ë°ì´í„°ì— ì¼ë¶€ ì—°ì†í˜• ë°ì´í„°ë¥¼ ë²”ì£¼í˜• ë°ì´í„°ë¡œ ë³€í™˜í•©ë‹ˆë‹¤.** <br>
<br>	

**4. 2ë²ˆ ë°ì´í„°ì— í´ëŸ¬ìŠ¤í„°ë§ì„ í†µí•œ ë¼ë²¨ featureë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.**
<br>

|![data](https://github.com/user-attachments/assets/f4924aeb-f8cd-4873-804e-35abd535c010)|![data2](https://github.com/user-attachments/assets/997d3b34-db4d-4b90-824f-ac31b70cedb7)|
|----------------------------------|----------------------------------------|

<br>

<hr>

### EDA

#### 1. Churnì— ë”°ë¥¸ ì‹œê°í™”
![íƒ€ê²Ÿì— ë”°ë¥¸ ì‹œê°í™”](https://github.com/user-attachments/assets/2e3d1aa8-d56b-44bb-a922-83e3b28da42a)

#### 2. XGBoost Feature Importanceì— ë”°ë¥¸ feature ì‹œê°í™”
- recallì´ ê°€ì¥ ë†’ì€ ë°ì´í„°ì˜ Feature Importanceì— ë”°ë¼ ìƒìœ„ 3ê°œì— ëŒ€í•œ ì‹œê°í™”<br>
<br>

![xgboost feature importance ê¸°ì¤€ ìƒìœ„ 3ê°œ ì‹œê°í™”](https://github.com/user-attachments/assets/627f2f01-a3e0-4b1e-ad50-a56f4682dccf)
<br>
<br>
- countplotê³¼ kdeplotì„ ë³´ì•˜ì„ ë•Œ ê°œë³„ featureì— ëŒ€í•œ Churnì˜ Yesì˜ ê°œìˆ˜ê°€ Noë³´ë‹¤ ë§ì€ ê²ƒì´ ì—†ìœ¼ë©°, ë¹„ìœ¨ë„ ë™ì¼í•œ ë¹„ìœ¨ë§Œ ì¡´ì¬í•˜ì—¬ 1ë²ˆì˜ ë°ì´í„°ë¡œëŠ” Churnì˜ Yes, Noë¥¼ êµ¬ë¶„í•  ë°©ë²•ì´ ì—†ëŠ” ê²ƒìœ¼ë¡œ íŒë‹¨ë©ë‹ˆë‹¤.

#### 3. ìƒˆë¡œìš´ Feature ìƒì„±

**3-1. ì—°ì†í˜• ë°ì´í„°ë¥¼ ë²”ì£¼í˜• ë°ì´í„°ë¡œ ìƒì„±**<br>
<br>

![ìŠ¤í¬ë¦°ìƒ· 2024-09-30 103817](https://github.com/user-attachments/assets/4533206a-b206-43e1-8a62-50566bd6111f)

**3-2. Clusteringì„ í†µí•œ ìƒˆë¡œìš´ label ìƒì„±**<br>
- KMeans í™œìš©<br>
<br>

![ì—°ì†ì—ì„œ ë²”ì£¼í˜• ë°ì´í„°ë¡œ ë³€í™˜](https://github.com/user-attachments/assets/511b0819-a5a5-434b-962f-1b58a83c1f80)

#### 4. Type ë³€ê²½
- 3ë²ˆì—ì„œ 2ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ìƒˆë¡œìš´ featureì„ ìƒì„±í•˜ì˜€ì§€ë§Œ EDAìƒ ìœ ì˜ë¯¸í•œ ì •ë³´ë¥¼ ì°¾ì§€ ëª»í•˜ì—¬ ì‹¤í–‰í•©ë‹ˆë‹¤.<br>
<br>

![imshow_type ë³€ê²½](https://github.com/user-attachments/assets/c4874927-58b2-4fa3-bf98-93b9faa04ae4)

- Heatmapì„ í†µí•˜ì—¬ Churnê³¼ ë‹¤ë¥¸ featureë“¤ê°„ì— ìœ ì˜ë¯¸í•œ ìƒê´€ê´€ê³„ëŠ” ë³´ì´ì§€ ì•ŠìŠµë‹ˆë‹¤.
<br>

#### 5. ì†Œê±°ë²•

**5-1. ê¸°ì¡´ Feature ì œê±°ë¥¼ í†µí•œ ë°ì´í„° í˜¼ì¡ì„± ê°œì„  ì‹œë„** <br>
<br>
ìœ ì‚¬ì„± ìˆëŠ” ë°ì´í„° ì†Œê±°: Service Area/Prizm Code, Occupation/CreditRating/Incomegroup ë“± ìœ ì‚¬ì„±ìˆëŠ” ë°ì´í„°,<br>
í˜¹ì€ Churn User Demographic ë¶„ì„ì— ì¤‘ìš”ë„ ë–¨ì–´ì§€ëŠ” ë°ì´í„° ì œê±°í•˜ì˜€ìŠµë‹ˆë‹¤.<br>
"TotalRecurringCharge, MonthsInService, AgeHH1, AgeHH2, MonthlyMinutes, MonthlyRevenue, CurrentEquipmentDays, Incomegroup"<br>
Upper, lowerquartile ì œê±°í•˜ì—¬ ë°ì´í„° ê°œì„  ì—¬ì§€ ì²´í¬í•©ë‹ˆë‹¤.<br>

<br>
- Churnê³¼ featureê°„ì˜ ìœ ì˜ë¯¸í•œ ê´€ê³„ê°€ ìˆëŠ” ë°ì´í„°ëŠ” ì—†ë‹¤ê³  íŒë‹¨ë©ë‹ˆë‹¤. <br>
ë”°ë¼ì„œ ê¸°ë³¸ì ì¸ modelì„ ì‹¤í–‰í–ˆì„ ë•Œì˜ ì˜ˆìƒë˜ëŠ” Scoreì€ ë‘˜ì˜ ë¹„ìœ¨ì¸ 0.71ì— ê·¼ì ‘í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¬ ê²ƒ ê°™ìŠµë‹ˆë‹¤.<br>
targetì˜ ë°ì´í„°ê°€ ë¶ˆê· ì¼í•˜ê¸° ë•Œë¬¸ì— accuracyë³´ë‹¤ precisionê³¼ recallì˜ ê²°ê³¼ì— ëŒ€í•˜ì—¬ ì£¼ì˜í•´ì•¼í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.

<hr>

### Modeling

#### Machine Learning

- ë°ì´í„° ì „ì²˜ë¦¬ í›„ ë¶„ë¥˜ taskì— ì í•©í•˜ê³  accuracyë¥¼ ì˜ ë‚˜ì˜¤ëŠ” ëª¨ë¸ì„ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤.

#### Deep Learning

- ëª¨ë¸ ì„ ì • ê¸°ì¤€: ì‹œê³„ì—´ ê´€ë ¨ ë°ì´í„°ê°€ ì—†ì–´ RNN, LSTM ì œì™¸, ê·¸ ì™¸ì—ë„ ë°ì´í„°ê°€ ë³µì¡í•˜ì§€ ì•Šì•„(ì´ë¯¸ì§€, ì˜ìƒ ë“±ì´ ì•„ë‹ˆë¯€ë¡œ) MLP ì„ ì •í–ˆìŠµë‹ˆë‹¤.

- ë¬¸ì œ ë° í•´ê²°ë°©ì•ˆ:
    - ì •í™•ë„ëŠ” ì˜ ë‚˜ì™”ìœ¼ë‚˜ lossìˆ˜ì¹˜ê°€ 0.58ë¡œ ë†’ì•˜ìŠµë‹ˆë‹¤. <br>
    1. batch_size, learning_rate, hidden_dim, dropout_ratio ë“± ìˆ˜ë™ìœ¼ë¡œ parameterë¥¼ ì¡°ì •í–ˆìŠµë‹ˆë‹¤. <br>
    1-1. layerìˆ˜ë¥¼ 2ê°œì—ì„œ 3ê°œë¡œ ëŠ˜ë ¸ìŠµë‹ˆë‹¤. <br>
    1-2. Optimizer Adamì—ì„œ AdamWë¡œ ë³€ê²½í•˜ì˜€ìœ¼ë‚˜ ìœ ì˜ë¯¸í•œ ì°¨ì´ê°€ ì—†ì—ˆìŠµë‹ˆë‹¤.<br>
    <br>
    2. recallì´ 1.0ì´ë¼ëŠ” ìˆ˜ì¹˜ê°€ ë‚˜ì˜¤ëŠ” í˜„ìƒì´ ë°œìƒí–ˆìŠµë‹ˆë‹¤.<br>
    2-1. output_dimì„ 1ì—ì„œ 2ë¡œ ëŠ˜ë¦¬ê³  softmax()ë¥¼ ì‚¬ìš©í•˜ì˜€ìœ¼ë©°, ì†ì‹¤í•¨ìˆ˜ë¥¼ã„¹ BCEì—ì„œ CEë¡œ ë³€ê²½í–ˆìŠµë‹ˆë‹¤.<br>
    <br>
    3. nnië¥¼ í†µí•œ parameter tuningì—ì„œ ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

<hr>

### ìˆ˜í–‰ ê²°ê³¼

#### Machine Learning

**XGBoost**
**1. ëª¨ë¸ í‰ê°€ ê²°ê³¼** <br>

![xgboost_result1](https://github.com/user-attachments/assets/b6b2a3d4-b631-4e9b-b6cb-11237f5139ae)

**2. Feature Importance** <br>
- recallì´ ê°€ì¥ ë†’ì€ ë°ì´í„°ì˜ feature importanceë¥¼ í™•ì¸í•©ë‹ˆë‹¤. <br>
- ìœ„ì˜ ê³¼ì •ì„ ê±°ì¹œ í›„ì— ì¤‘ìš”ë„ê°€ ë‚®ì€ featureë¶€í„° í•˜ë‚˜ì”© ì œê±°í•˜ë©´ì„œ ë¹„êµí•©ë‹ˆë‹¤. <br>

|![xgboost_feature_drop1](https://github.com/user-attachments/assets/f72f8914-defa-4a03-b831-5395fe253233)|![xgboost_feature_drop5](https://github.com/user-attachments/assets/c305ee92-23ae-4764-8d06-872a9c05bf16)|![xgboost_feature_drop20](https://github.com/user-attachments/assets/709448ff-5dc8-4194-adbf-bd91315e1414)|
|-----------------------|-----------------------|-----------------------|

<br>
<br>

**LightGBM**
<br>
**1. ëª¨ë¸ í‰ê°€ ê²°ê³¼** <br>

![lightgbm_result](https://github.com/user-attachments/assets/dccef868-f87f-41bc-acb1-a9b684a1281b)

**2. Feature Importance** <br>
- recallì´ ê°€ì¥ ë†’ì€ ë°ì´í„°ì˜ feature importanceë¥¼ í™•ì¸í•©ë‹ˆë‹¤. <br>
- ìœ„ì˜ ê³¼ì •ì„ ê±°ì¹œ í›„ì— ì¤‘ìš”ë„ê°€ ë‚®ì€ featureë¶€í„° í•˜ë‚˜ì”© ì œê±°í•˜ë©´ì„œ ë¹„êµí•©ë‹ˆë‹¤. <br>

|![lgbm_drop1](https://github.com/user-attachments/assets/5b32d1c6-494d-44b4-a198-9fc8e19d5cac)|![lgbm_drop5](https://github.com/user-attachments/assets/bb091f7e-ea7c-4d65-acca-6e7947e8f5de)|![lgbm_drop20](https://github.com/user-attachments/assets/c7ef9523-10d1-4ab7-828e-3d0e5dca982c)|
|-----------------------|-----------------------|-----------------------|

> XGBoostì™€ LGBMì˜ ê°ê° ê¸°ì¡´ ë°ì´í„°ë¡œ ëª¨ë¸ì„ ì‹¤í–‰í•˜ì˜€ì„ ë•Œ recallê°’ì—ì„œ ìœ ì˜ë¯¸í•œ ë³€í™”ê°€ ì—†ë‹¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

#### Deep Learning

**Test Dataloader**
![DL_result](https://github.com/user-attachments/assets/d10430e6-ec61-4eec-a59d-acbe61141bf9)
<br>

**nni ê²°ê³¼**

![nni_result](https://github.com/user-attachments/assets/4202742b-1504-4e49-baa3-03993b899b9e)

> ë¨¸ì‹ ëŸ¬ë‹ì—ì„œ XGBoostë¥¼ ì‚¬ìš©í•˜ì—¬ ì •í™•ë„ê°€ 72% ì •ë„ê°€ ë‚˜ì™”ìœ¼ë©°, <br>
> ë”¥ëŸ¬ë‹ì—ì„œ MLPë¥¼ ì‚¬ìš©í•˜ì—¬ ì •í™•ë„ê°€ 71% ì •ë„ê°€ ë‚˜ì™”ìŠµë‹ˆë‹¤. <br>
> í˜„ì¬/ì´íƒˆ ê³ ê°ë“¤ì„ ëŒ€ìƒìœ¼ë¡œ ë§Œì¡±ë„ ì¡°ì‚¬ë¥¼ ì§„í–‰í•˜ë©´ í›¨ì”¬ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì¼ ê²ƒìœ¼ë¡œ ê¸°ëŒ€ë©ë‹ˆë‹¤.


<hr>

### í•œ ì¤„ íšŒê³ 
```
ë°•ì§„íš¨ - ê³ ìƒ ë§ì´ í•œ íŒ€ì›ë“¤ ê°ì‚¬í•©ë‹ˆë‹¤. ë¶€ì¡±í•œ íŒ€ì¥ì´ë¼ ë¯¸ì•ˆí•©ë‹ˆë‹¤.
```
```
ê³ ìœ ë¦¼ - ì–´ë ¤ì› ìŠµë‹ˆë‹¤. í•œë°œì§ ì¢€ ë” ë‚˜ê°€ì•„ê°”ë˜ ì‹œê°„ì´ì—ˆìŠµë‹ˆë‹¤.
```
```
ì´ì§„ì„­ - í™˜ê²½ ì„¤ì •ì—ì„œ ì—¬ëŸ¬ ì´ìŠˆë¥¼ ê²ªìœ¼ë©° í•´ê²°í•˜ëŠ” ë° ë§ì€ ì• ë¥¼ ë¨¹ì—ˆì§€ë§Œ, ì•ìœ¼ë¡œëŠ” ë” ì‹ ì¤‘í•˜ê²Œ ì„¤ì •í•´ì•¼ê² ë‹¤.
```
```
ì´í˜¸ì¬ - ë‹¤ë“¤ ê³ ìƒí•˜ì…¨ê³  ì£¼ë§ì´ê»´ì„œ ë” í˜ë“  ëŠë‚Œì´ ë“œë„¤ìš”.
```
```
ì „ìš±ì§„ - ë°ì´í„°ë¥¼ ì•„ë¬´ë¦¬ ë´ë„ ëª¨ë¥´ê² ì–´ìš”
```